
## RAG是什么
1.RAG（Retrieve and Generate）技术是一种增强大模型准确性和实时性的方法。
2.RAG技术通过检索外部数据来增强大模型的生成效果，减少幻觉问题。
3.RAG技术的工作流程包括索引化、数据分割、存储、检索、拼接和生成最终答案。

## 大模型存在的问题
1.大模型存在幻觉问题，即回答的内容与实际情况不符或前后矛盾。
- 幻觉问题源于大模型的架构设计，尤其是transformer架构的概率填充特性。
2.大模型的数据更新缓慢，无法实时更新最新数据。——RAG技术通过检索外部数据来增强大模型的生成效果。
3.大模型对专业领域知识的认知有限，尤其在广度优先的训练数据选择下。——RAG技术可以引入专业领域的知识进行回复，提高回答的准确性和时效性。

## RAG技术的实现流程
1.RAG技术的实现流程包括索引化、数据分割、存储、检索、拼接和生成最终答案。
2.索引化：将文档进行分片和存储，便于后续（全文）检索。
3.数据分割：将文档分割成小块，便于检索和存储。
4.存储：将分割后的数据存储到向量数据库中，转换为向量形式。
5.检索：根据用户问题在向量数据库中检索最相似的数据。
6.拼接：将检索到的数据与用户问题拼接，生成最终答案。

## RAG技术的演进
1.RAG技术的演进分为三个阶段：naive RAG、address RAG和module RAG。
2.naive RAG：基本的RAG流程，包括索引化、数据分割、存储、检索和拼接。
3.address RAG：在naive RAG基础上增加了前索引和后索引，提高检索效果。
4.module RAG：将RAG功能模块化，便于独立优化和扩展。

naive RAG技术的核心步骤包括文档获取、数据标注、文档分块、向量转换和存储。
- 文档获取：获取所需文档数据，可能需要进行数据清洗。
- 数据标注：对文档数据进行标注，确保数据质量和准确性。
- 文档分块：将文档分割成小块，便于后续处理和检索。
- 向量转换：将文档数据转换为向量形式，提高检索效率。
- 存储：将向量数据存储到数据库中，便于快速检索。

## 文档分块的方法
1.文档分块的方法包括按句子分割、按字数分割、按固定字符分割和递归分割。
2.按句子分割：根据标点符号将文档分割成句子。
3.按字数分割：将文档按固定字数（如100个字符）进行分割。
4.按固定字符分割：将文档按固定字符（如50个字符）进行重叠分割，确保语义完整。
5.递归分割：递归地将文档按固定长度进行分割，确保语义完整。


递归分割器优先使用反斜杠n进行分割，但需要空字符的优先级高于check size。
递归分割的逻辑是在分割完反斜杠n后，再根据空字符和控制符进行分割。
分割后的数据会变成单独的数据点，每个字符都会变成单独的向量。
如果数据长度小于分割值，则会合并数据；大于分割值则确保语义完整。

语义完整性，就是确保代码和数据在分割后的完整性。
递归分割器通过优先使用句号等语义符号进行分割，确保语义的完整性。语义完整的代码和数据在后续处理中更加准确和可靠。
from langchain.text_splitter import RecursiveCharacterTextSplitter
separators指定顺序：\n优先，然后是。 最后是空格。

## 向量的表示
1.向量在数学中表示为带箭头的线段，有大小和方向。
2.在编程中，向量用数组表示，每个下标I对应一个维度。
3.向量的维度可以很高，甚至达到几千维。

文本向量转换是将文本转换成一组浮点数，表示文本的语义特征。
向量之间的距离可以计算语义的相似度。通过计算余弦相似度和欧式距离来评估向量之间的相似度。

机器学习中常用One-Hot编码将字符转换为向量。
One-Hot编码将每个字符表示为一个高维向量，维度等于字符集大小。总共有N维，只有那个字符对应的位为1。
One-Hot编码适用于处理离散特征，但在高维空间中会占用大量内存。

## 嵌入向量（Embedding Vector）
1.嵌入是将高维向量映射到低维空间，同时保持语义关系。
2.嵌入过程通过算法将高维向量降维，同时保留重要的语义特征。嵌入后的向量仍能表示原始数据的语义信息。

使用成熟的向量模型将文本转换为向量，无需自行进行表示学习和嵌入。
常见的向量模型包括千问、百度文心等。通过OpenAI等平台连接向量模型，进行文本向量的转换。
